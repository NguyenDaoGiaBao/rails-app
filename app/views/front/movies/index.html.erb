<% content_for :styles do %>
  <%= stylesheet_link_tag "custom-pagination" %>
<% end %>
<% content_for :title, "Đặt vé của tôi - CinemaKD" %>

<div class="container mx-auto px-4 py-8">
  <h1 class="text-3xl font-bold mb-6">Danh sách phim</h1>

  <!-- Search and Filter -->
  <div class="flex flex-col md:flex-row justify-between mb-6 gap-4">
    <div class="relative w-full md:w-72">
      <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
        <i class="fas fa-search text-gray-400"></i>
      </div>
      <input
        type="text"
        id="search-input"
        class="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500"
        placeholder="Tìm kiếm phim..."
        />
    </div>

    <div class="flex items-center space-x-2">
      <i class="fas fa-filter text-gray-500"></i>
      <select
        id="filter-select"
        class="block w-full pl-3 pr-10 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500"
      >
        <option value="all">Tất cả phim</option>
        <option value="now-showing">Đang chiếu</option>
        <option value="coming-soon">Sắp chiếu</option>
      </select>
    </div>
  </div>

  <!-- Movies Grid -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="movies-grid">
    <% @movies.each do |movie| %>
      <div class="bg-white rounded-lg shadow overflow-hidden transition-transform hover:shadow-lg">
        <div class="relative h-64 w-full bg-gray-300">
          <img src="<%= movie.poster_url || url_for(movie.poster_image) %>" alt="Movie" class="w-full h-full object-cover">
          <div class="absolute top-2 left-2 text-xs font-semibold px-2 py-1 rounded">
            <% case movie.status %>
            <% when 'active' %>
              <span class="badge bg-success">Đang chiếu</span>
            <% when 'inactive' %>
              <span class="badge bg-secondary">Không hoạt động</span>
            <% when 'coming_soon' %>
              <span class="badge bg-warning">Sắp chiếu</span>
            <% end %>
          </div>
        </div>
        <div class="p-4">
          <h3 class="text-lg font-semibold mb-1 truncate"><%= movie.title %></h3>
          <div class="flex items-center text-sm text-gray-600 mb-2">
                        <span class="flex items-center mr-3">
                            <i class="fas fa-star text-yellow-500 mr-1"></i>
                            9.0/10
                        </span>
            <span><%= movie.duration %> phút</span>
          </div>
          <p class="text-gray-500 text-sm line-clamp-2 mb-3">
            <% if movie.description %>
              <%= movie.description %>
            <% else %>
              Chưa có mô tả
            <% end %>
          </p>
          <a href="movie-detail.html" class="inline-flex items-center justify-center w-full px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors">
            <i class="fas fa-calendar-alt mr-2"></i> Xem lịch chiếu
          </a>
        </div>
      </div>
    <% end %>
  </div>

  <!-- Pagination -->
  <div class="d-flex justify-content-center mt-4">
    <%= paginate @movies, window: 2 %>
  </div>
</div>
